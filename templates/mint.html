<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>–°–æ–∑–¥–∞—Ç—å –Ω–æ–º–µ—Ä</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@700&display=swap" rel="stylesheet">
  <style>
    html, body {
      height:100%; margin:0; padding:0;
      font-family:'Noto Sans JP',sans-serif;
      background:linear-gradient(135deg,#f5f7fa,#c3cfe2);
      overflow:hidden;
    }
    .fixed-header {
      position:fixed; top:0; left:0; width:100%; height:70px;
      background:#fff; box-shadow:0 2px 4px rgba(0,0,0,0.1);
      display:flex; align-items:center; padding:0 20px; z-index:1000;
    }
    .fixed-header h1 {
      flex:1; text-align:center; font-size:1.5rem; margin:0;
    }
    .content {
      position:absolute; top:80px; bottom:0; left:0; right:0;
      overflow-y:auto; padding:10px 20px;
    }
    /* create-card */
    .create-card {
      width:280px; height:140px; margin:30px auto;
      border-radius:15px; background:linear-gradient(135deg,rgba(255,255,255,0.1),rgba(0,0,0,0.1));
      box-shadow:0 4px 6px rgba(0,0,0,0.1);
      display:flex; flex-direction:column; justify-content:center; align-items:center;
      cursor:pointer; transition:.3s;
    }
    .create-card:hover {
      transform:scale(1.05); box-shadow:0 8px 16px rgba(0,0,0,0.2);
    }
    .plus-sign {
      font-size:3rem; line-height:1; color:#999;
    }
    .create-text {
      font-size:0.85rem; color:#666;
      white-space:nowrap;
    }
    /* –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö */
    .recent-title {
      font-size:1rem; text-align:center; margin:20px 0 10px;
      white-space:nowrap;
    }
    /* –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤ */
    .token-card {
      position:relative; border:none; border-radius:15px;
      padding:15px; text-align:center; cursor:pointer;
      box-shadow:0 4px 6px rgba(0,0,0,0.1); transition:.3s;
      overflow:hidden;
    }
    .token-card:hover {
      transform:scale(1.05); box-shadow:0 8px 16px rgba(0,0,0,0.2);
    }
    .token-number {
      font-family:'Lato',sans-serif; font-size:1.8rem;
      font-weight:700; margin:0;
    }
    .rarity-badge {
      position:absolute; top:8px; right:8px;
      background:#ff9800; color:#fff; padding:3px 6px;
      border-radius:12px; font-size:0.7rem; font-weight:600;
    }
  </style>
</head>
<body>
  <div class="fixed-header">
    <a href="/"><img src="/static/butons/home.png" alt="Home" style="height:36px;"></a>
    <h1>–°–æ–∑–¥–∞—Ç—å –Ω–æ–º–µ—Ä</h1>
    <div style="width:36px;"></div>
  </div>

  <div class="content">
    {% if error %}
      <div class="alert alert-danger text-center">{{ error }}</div>
    {% endif %}

    <!-- –∫–Ω–æ–ø–∫–∞ + -->
    <div class="create-card" data-toggle="modal" data-target="#createModal">
      <div class="plus-sign">+</div>
      <div class="create-text">–°–æ–∑–¥–∞—Ç—å NFT –Ω–æ–º–µ—Ä</div>
    </div>

    <!-- –ø–æ—Å–ª–µ–¥–Ω–∏–µ -->
    <div class="recent-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–º–µ—Ä–∞</div>
    <div class="row no-gutters">
      {% for token in recent_tokens %}
        <div class="col-6 px-2 mb-3">
          <div class="token-card" data-toggle="modal" data-target="#tokenModal-{{ token.token }}"
            {% if token.bg_is_image %}
              style="background:url('{{ token.bg_color }}') no-repeat center/cover; {% if token.bg_rarity=='0.1%' %}border:2px solid gold;{% endif %}"
            {% elif 'gradient' in token.bg_color %}
              style="background:{{ token.bg_color }}; {% if token.bg_rarity=='0.1%' %}border:2px solid gold;{% endif %}"
            {% else %}
              style="background-color:{{ token.bg_color }}; {% if token.bg_rarity=='0.1%' %}border:2px solid gold;{% endif %}"
            {% endif %}>
            {% if token.overall_rarity != '–û–±—ã—á–Ω—ã–π' %}
              <div class="rarity-badge">{{ token.overall_rarity }}</div>
            {% endif %}
            <div class="token-number">
              {% if 'gradient' in token.text_color %}
                <span style="background:{{ token.text_color }};
                             -webkit-background-clip:text; color:transparent;">
                  {{ token.token }}
                </span>
              {% else %}
                <span style="color:{{ token.text_color }};">
                  {{ token.token }}
                </span>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- –º–æ–¥–∞–ª–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è -->
    <div class="modal fade" id="createModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog"><div class="modal-content" style="border-radius:15px;">
        <div class="modal-header">
          <h5 class="modal-title">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –Ω–æ–º–µ—Ä</h5>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="text-center p-2">
          <img src="/static/butons/tutorial.gif" class="img-fluid">
        </div>
        <div class="modal-body text-center">
          {% if attempts_left > 0 %}
            <p>–£ –≤–∞—Å <strong>{{ attempts_left }}</strong> –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫</p>
          {% else %}
            <p>–ü–æ–ø—ã—Ç–∫–∏ –∫–æ–Ω—á–∏–ª–∏—Å—å. –°–æ–∑–¥–∞—Ç—å –∑–∞ <strong>100 üíé</strong> (–±–∞–ª–∞–Ω—Å: {{ balance }} üíé)</p>
          {% endif %}
        </div>
        <div class="modal-footer">
          <form method="post" action="/mint">
            <input type="hidden" name="user_id" value="{{ user_id }}">
            {% if attempts_left > 0 %}
              <button class="btn btn-primary">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</button>
            {% else %}
              <button class="btn btn-success" {% if balance<100 %}disabled{% endif %}>–ó–∞ 100 üíé</button>
            {% endif %}
          </form>
          <button class="btn btn-secondary" data-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
        </div>
      </div></div>
    </div>

    <!-- –º–æ–¥–∞–ª–∫–∏ –¥–µ—Ç–∞–ª–µ–π -->
    {% for token in recent_tokens %}
      <div class="modal fade" id="tokenModal-{{ token.token }}" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered"><div class="modal-content">
          <div class="modal-header"
            {% if token.bg_is_image %}
              style="background:url('{{ token.bg_color }}') no-repeat center/cover;"
            {% elif 'gradient' in token.bg_color %}
              style="background:{{ token.bg_color }};"
            {% else %}
              style="background-color:{{ token.bg_color }};"
            {% endif %}>
            <h5 class="modal-title">–ù–æ–º–µ—Ä {{ token.token }}</h5>
            <button class="close" data-dismiss="modal">&times;</button>
          </div>
          <div class="modal-body text-center">
            <div class="token-card modal-token-card mb-3"
                 {% if token.bg_is_image %}
                   style="background:url('{{ token.bg_color }}') no-repeat center/cover;"
                 {% elif 'gradient' in token.bg_color %}
                   style="background:{{ token.bg_color }};"
                 {% else %}
                   style="background-color:{{ token.bg_color }};"
                 {% endif %}>
              <h4 class="token-number">
                {% if 'gradient' in token.text_color %}
                  <span style="background:{{ token.text_color }};
                               -webkit-background-clip:text; color:transparent;">{{ token.token }}</span>
                {% else %}
                  <span style="color:{{ token.text_color }};">{{ token.token }}</span>
                {% endif %}
              </h4>
            </div>
            <p><strong>–ù–æ–º–µ—Ä:</strong> {{ token.number_rarity }}</p>
            <p><strong>–¶–∏—Ñ—Ä—ã:</strong> {{ token.text_rarity }}</p>
            <p><strong>–§–æ–Ω:</strong> {{ token.bg_rarity }}</p>
            <p><strong>–û–±—â–∞—è:</strong> {{ token.overall_rarity }}</p>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" data-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
          </div>
        </div></div>
      </div>
    {% endfor %}

  </div>

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
