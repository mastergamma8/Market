<!-- templates/market.html -->
{% extends "base.html" %}
{% block title %}TTH Market - Market{% endblock %}

{% block content %}
<div class="container">
  <h3 class="my-3">–ù–æ–º–µ—Ä–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∂–µ</h3>
  <div class="row">
    {% for listing in market %}
      <div class="col-md-6 mb-3">
        <div class="token-card"
             onclick="window.location.href='/profile/{{ listing.seller_id }}'"
             style="background-color: {{ listing.token.bg_color }}; color: {{ listing.token.text_color }};">
          {% if listing.token.overall_rarity != '–û–±—ã—á–Ω—ã–π' %}
            <div class="rarity-badge">{{ listing.token.overall_rarity }}</div>
          {% endif %}
          <div class="token-number">{{ listing.token.token }}</div>
          <p>–†–µ–¥–∫–æ—Å—Ç—å –Ω–æ–º–µ—Ä–∞: {{ listing.token.number_rarity }}</p>
          <p>–†–µ–¥–∫–æ—Å—Ç—å —Ü–∏—Ñ—Ä: {{ listing.token.text_rarity }}</p>
          <p>–†–µ–¥–∫–æ—Å—Ç—å —Ñ–æ–Ω–∞: {{ listing.token.bg_rarity }}</p>
          <p>–û–±—â–∞—è —Ä–µ–¥–∫–æ—Å—Ç—å: {{ listing.token.overall_rarity }}</p>
          <p>–¶–µ–Ω–∞: {{ listing.price }} üíé</p>
          <p>–ü—Ä–æ–¥–∞–≤–µ—Ü: {{ users.get(listing.seller_id, {}).get('username', listing.seller_id) }}</p>
          <form action="/buy/{{ loop.index0 }}" method="post">
            {% if buyer_id %}
              <input type="hidden" name="buyer_id" value="{{ buyer_id }}">
            {% endif %}
            <button type="submit" class="btn btn-primary btn-sm">–ö—É–ø–∏—Ç—å</button>
          </form>
        </div>
      </div>
    {% endfor %}
  </div>
</div>
{% endblock %}
