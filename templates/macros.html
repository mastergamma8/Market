{# templates/macros.html #}

{% macro card_wrapper(token, idx) %}
<div class="col-md-4 mb-3">
  <div class="card-wrapper" style="position: relative;" data-id="{{ token.token }}">
    {# â€”â€”â€”â€”â€”â€”â€”â€” Ğ‘ĞµĞ¹Ğ´Ğ¶ Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ½Ğ¾Ğ¼ĞµÑ€Ğ° â€”â€”â€”â€”â€”â€”â€”â€” #}
    {% if token.bg_sequence_number %}
      <div class="order-badge">#{{ token.bg_sequence_number }}</div>
    {% endif %}
    {# â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” #}
    <div class="card token-card"
      {% if token.bg_is_image %}
        style="background: url('{{ token.bg_color }}') no-repeat center/cover; {% if token.bg_rarity == '0.1%' %}border:3px solid gold;{% endif %}"
      {% elif 'linear-gradient' in token.bg_color %}
        style="background: {{ token.bg_color }}; {% if token.bg_rarity == '0.1%' %}border:3px solid gold;{% endif %}"
      {% else %}
        style="background-color: {{ token.bg_color }}; {% if token.bg_rarity == '0.1%' %}border:3px solid gold;{% endif %}"
      {% endif %}
      data-toggle="modal" data-target="#tokenModal{{ idx }}">
      {% if token.overall_rarity != 'ĞĞ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¹' %}
        <div class="rarity-badge">{{ token.overall_rarity }}</div>
      {% endif %}
      <div class="card-body text-center">
        <h4 class="token-number">
          {% if 'linear-gradient' in token.text_color %}
            <span style="background: {{ token.text_color }};
                         -webkit-background-clip: text; color: transparent;">
              {{ token.token }}
            </span>
          {% else %}
            <span style="color: {{ token.text_color }};">{{ token.token }}</span>
          {% endif %}
        </h4>
      </div>
      {% if token.bg_availability %}
        <div class="token-availability">
          {{ token.bg_availability | replace("ĞĞ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ: ","") | replace("/"," Ğ¸Ğ· ") }}
        </div>
      {% endif %}
    </div>
  </div>
</div>
{% endmacro %}


{% macro token_modal(token, idx, is_owner, user, user_id) %}
<div class="modal fade" id="tokenModal{{ idx }}" tabindex="-1" role="dialog"
     aria-labelledby="tokenModalLabel{{ idx }}" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header token-details"
           {% if token.bg_is_image %}
             style="background: url('{{ token.bg_color }}') no-repeat center/cover;"
           {% elif 'linear-gradient' in token.bg_color %}
             style="background: {{ token.bg_color }};"
           {% else %}
             style="background-color: {{ token.bg_color }};"
           {% endif %}>
        <h5 class="modal-title" id="tokenModalLabel{{ idx }}">Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ½Ğ¾Ğ¼ĞµÑ€Ğ°</h5>
        <button type="button" class="close" data-dismiss="modal"><span>&times;</span></button>
      </div>
      <div class="modal-body">
        <div class="text-center mb-3">
          <div class="token-card modal-token-card"
               {% if token.bg_is_image %}
                 style="background: url('{{ token.bg_color }}') no-repeat center/cover; {% if token.bg_rarity=='0.1%' %}border:3px solid gold;{% endif %}"
               {% elif 'linear-gradient' in token.bg_color %}
                 style="background: {{ token.bg_color }}; {% if token.bg_rarity=='0.1%' %}border:3px solid gold;{% endif %}"
               {% else %}
                 style="background-color: {{ token.bg_color }}; {% if token.bg_rarity=='0.1%' %}border:3px solid gold;{% endif %}"
               {% endif %}>
            <h4 class="token-number">
              {% if 'linear-gradient' in token.text_color %}
                <span style="background: {{ token.text_color }};
                             -webkit-background-clip: text; color: transparent;">
                  {{ token.token }}
                </span>
              {% else %}
                <span style="color: {{ token.text_color }};">{{ token.token }}</span>
              {% endif %}
            </h4>
          </div>
        </div>

        <p><strong>Ğ ĞµĞ´ĞºĞ¾ÑÑ‚ÑŒ Ğ½Ğ¾Ğ¼ĞµÑ€Ğ°:</strong> {{ token.number_rarity }}</p>
        <p><strong>Ğ ĞµĞ´ĞºĞ¾ÑÑ‚ÑŒ Ñ†Ğ¸Ñ„Ñ€:</strong> {{ token.text_rarity }}</p>
        <p><strong>Ğ ĞµĞ´ĞºĞ¾ÑÑ‚ÑŒ Ñ„Ğ¾Ğ½Ğ°:</strong> {{ token.bg_rarity }}</p>

        {% if token.bg_availability %}
          <p><strong>ĞĞ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ:</strong> {{ token.bg_availability }}</p>
        {% endif %}

        {# â€”â€”â€”â€”â€”â€”â€”â€” ĞŸĞ¾Ñ€ÑĞ´ĞºĞ¾Ğ²Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ñ„Ğ¾Ğ½Ğ° Ğ² Ğ¼Ğ¾Ğ´Ğ°Ğ»ĞºĞµ â€”â€”â€”â€”â€”â€”â€”â€” #}
        {% if token.bg_sequence_number %}
          <p><strong>ĞŸĞ¾Ñ€ÑĞ´ĞºĞ¾Ğ²Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ñ„Ğ¾Ğ½Ğ°:</strong> #{{ token.bg_sequence_number }}</p>
        {% endif %}
        {# â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” #}

        <p><strong>ĞĞ±Ñ‰Ğ°Ñ Ñ€ĞµĞ´ĞºĞ¾ÑÑ‚ÑŒ:</strong> {{ token.overall_rarity }}</p>
        <p><strong>Ğ’Ñ€ĞµĞ¼Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ:</strong> {{ token.timestamp }}</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-dismiss="modal">Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ</button>
        {% if is_owner %}
          {% if user.custom_number and user.custom_number.token == token.token %}
            <form action="/remove_profile_token" method="post" style="display:inline-block;">
              <input type="hidden" name="user_id" value="{{ user_id }}">
              <button class="btn btn-warning">Ğ¡Ğ½ÑÑ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€</button>
            </form>
          {% else %}
            <form action="/set_profile_token" method="post" style="display:inline-block;">
              <input type="hidden" name="user_id"    value="{{ user_id }}">
              <input type="hidden" name="token_index" value="{{ idx }}">
              <button class="btn btn-success">ĞŸĞ¾ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ</button>
            </form>
          {% endif %}

          <!-- ĞšĞ½Ğ¾Ğ¿ĞºĞ° Ğ¾Ğ±Ğ¼ĞµĞ½ÑÑ‚ÑŒ Ğ½Ğ° 49 ğŸ’ -->
          <form class="swap49-form" action="/swap49" method="post" style="display:inline-block; margin-left:8px;">
            <input type="hidden" name="user_id"     value="{{ user_id }}">
            <input type="hidden" name="token_index" value="{{ idx }}">
            <button type="submit" class="btn btn-outline-success">ĞĞ±Ğ¼ĞµĞ½ÑÑ‚ÑŒ Ğ½Ğ° 49 ğŸ’</button>
          </form>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endmacro %}
